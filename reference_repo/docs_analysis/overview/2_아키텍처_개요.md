# Unity Perception ì•„í‚¤í…ì²˜ ê°œìš”

Unity Perception íŒ¨í‚¤ì§€ì˜ 5ëŒ€ í•µì‹¬ ì»´í¬ë„ŒíŠ¸ì™€ CCTV í”„ë¡œì íŠ¸ ì í•©ì„± í‰ê°€

---

## ğŸ“– ì´ ë¬¸ì„œëŠ”?

**ì½ê¸° ì‹œê°„**: 30ë¶„
**ëŒ€ìƒ**: ì•„í‚¤í…íŠ¸, ì‹œìŠ¤í…œ ì„¤ê³„ì
**ì „ì œ ì¡°ê±´**: [1_ë¹ ë¥¸ì‹œì‘.md](1_ë¹ ë¥¸ì‹œì‘.md) ì½ê¸° ì™„ë£Œ

**ëª©ì **:
- Unity Perceptionì˜ 5ê°œ í•µì‹¬ ì»´í¬ë„ŒíŠ¸ ìƒì„¸ ì´í•´
- CCTV í”„ë¡œì íŠ¸ì— ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ë¶€ë¶„ ì‹ë³„
- ì±„íƒí•´ì•¼ í•  ì•„í‚¤í…ì²˜ íŒ¨í„´ ì •ë¦¬

---

## ğŸ—ï¸ 5ëŒ€ í•µì‹¬ ì»´í¬ë„ŒíŠ¸

### 1ï¸âƒ£ Data Capture & Sensing

**ê°œìš”**: ì¹´ë©”ë¼ ìº¡ì²˜ ë° ì„¼ì„œ ê´€ë¦¬ ì‹œìŠ¤í…œ

#### PerceptionCamera (í•µì‹¬ ì»´í¬ë„ŒíŠ¸)

```
Unity GameObject
  â””â”€ Camera (Unity ê¸°ë³¸)
     â””â”€ PerceptionCamera (Component)
        â”œâ”€ captureRgbImages: bool
        â”œâ”€ framesBetweenCaptures: int
        â””â”€ labelers: List<CameraLabeler>
```

**ì£¼ìš” ì—­í• **:
- í”„ë ˆì„ ìŠ¤ì¼€ì¤„ë§ (ë§¤ í”„ë ˆì„ vs Ní”„ë ˆì„ë§ˆë‹¤)
- Labeler ìƒëª…ì£¼ê¸° ê´€ë¦¬ (Setup â†’ OnUpdate â†’ Cleanup)
- DatasetCaptureì™€ ë™ê¸°í™”
- Sensor ì •ì˜ ë“±ë¡

**CCTV í™œìš©**:
- âœ… **ê·¸ëŒ€ë¡œ ì‚¬ìš©**: ì¹´ë©”ë¼ ìº¡ì²˜ ì‹œìŠ¤í…œ
- âœ… **ì¬ì‚¬ìš©**: Labeler ê´€ë¦¬ íŒ¨í„´
- ğŸŸ¡ **í™•ì¥ í•„ìš”**: Multi-camera ë™ê¸°í™” (Phase 2)

**í•µì‹¬ íŒŒì¼**:
- `Runtime/GroundTruth/PerceptionCamera.cs` (27KB)

---

#### DatasetCapture (ì „ì—­ ê´€ë¦¬ì)

```csharp
// Static ë©”ì„œë“œë¡œ ì „ì—­ ì ‘ê·¼
DatasetCapture.RegisterSensor(sensorDefinition);
DatasetCapture.RegisterAnnotationDefinition(annotationDef);
DatasetCapture.RegisterMetric(metricDef);
```

**ì£¼ìš” ì—­í• **:
- ëª¨ë“  ì„¼ì„œ ë“±ë¡ ê´€ë¦¬
- í”„ë ˆì„ ìŠ¤ì¼€ì¤„ë§ ì¡°ìœ¨
- Annotation/Metric ì •ì˜ ìˆ˜ì§‘
- SimulationState ê´€ë¦¬

**CCTV í™œìš©**:
- âœ… **ê·¸ëŒ€ë¡œ ì‚¬ìš©**: ì „ì—­ ë ˆì§€ìŠ¤íŠ¸ë¦¬
- ğŸŸ¡ **í™•ì¥ í•„ìš”**: Multi-camera frame alignment

**í•µì‹¬ íŒŒì¼**:
- `Runtime/GroundTruth/DatasetCapture.cs` (32KB)
- `Runtime/GroundTruth/SimulationState.cs` (61KB)

---

#### CameraSensor (ì„¼ì„œ ì¶”ìƒí™”)

**ê¸°ë³¸ ì œê³µ ì„¼ì„œ**:
- `UnityCameraSensor`: í‘œì¤€ ì¹´ë©”ë¼
- `CircularFisheyeCameraSensor`: ì–´ì•ˆ ë Œì¦ˆ
- `CubemapCameraSensor`: ì „ë°©ìœ„ ìº¡ì²˜

**CCTV í™•ì¥**:
```csharp
// ìš°ë¦¬ê°€ ë§Œë“¤ ê²ƒ
public class CCTVFisheyeSensor : CameraSensor {
    // ì™œê³¡ ë³´ì • íŒŒë¼ë¯¸í„°
    public float distortionK1;
    public float distortionK2;

    // PTZ (Pan-Tilt-Zoom) ì§€ì›
    public float panAngle;
    public float tiltAngle;
    public float zoomFactor;
}
```

**í•µì‹¬ íŒŒì¼**:
- `Runtime/GroundTruth/Sensors/CameraSensor.cs`
- `Runtime/GroundTruth/Sensors/SensorTypes/CircularFisheyeCameraSensor.cs`

---

### 2ï¸âƒ£ Ground Truth Labelers

**ê°œìš”**: í”ŒëŸ¬ê·¸ì¸ ë°©ì‹ ë¼ë²¨ë§ ì‹œìŠ¤í…œ (15ê°œ ê¸°ë³¸ ì œê³µ)

#### Labeler íŒ¨í„´

```csharp
public abstract class CameraLabeler : MonoBehaviour {
    // í•„ìˆ˜ êµ¬í˜„
    public abstract string description { get; }
    public abstract string labelerId { get; }

    // ìƒëª…ì£¼ê¸°
    protected virtual void Setup() { }
    protected virtual void OnUpdate() { }
    protected virtual void OnEndRendering(ScriptableRenderContext ctx) { }
    protected virtual void Cleanup() { }

    // Annotation ë³´ê³ 
    protected SensorHandle sensorHandle;
}
```

**ì‘ë™ ë°©ì‹**:
1. `PerceptionCamera.Setup()`: ëª¨ë“  Labelerì˜ `Setup()` í˜¸ì¶œ
2. ë§¤ í”„ë ˆì„ `OnUpdate()`: Labelerê°€ `AsyncFuture<Annotation>` ë°˜í™˜
3. `Cleanup()`: ì‹œë®¬ë ˆì´ì…˜ ì¢…ë£Œ ì‹œ

---

#### ê¸°ë³¸ ì œê³µ Labelers (15ê°œ)

**Object Detection**:
- âœ… `BoundingBox2DLabeler`: 2D bbox (ìš°ë¦¬ê°€ ìƒì†í•  ê²ƒ)
- âœ… `BoundingBox3DLabeler`: 3D bbox
- âœ… `ObjectCountLabeler`: ì˜¤ë¸Œì íŠ¸ ê°œìˆ˜

**Segmentation**:
- âœ… `SemanticSegmentationLabeler`: í´ë˜ìŠ¤ë³„ ì„¸ê·¸ë©˜í…Œì´ì…˜
- âœ… `InstanceSegmentationLabeler`: ì¸ìŠ¤í„´ìŠ¤ë³„ ì„¸ê·¸ë©˜í…Œì´ì…˜

**Geometry**:
- âœ… `DepthLabeler`: Depth map
- âœ… `NormalLabeler`: Surface normal
- âœ… `PixelPositionLabeler`: 3D ì¢Œí‘œ

**Metadata**:
- âœ… `MetadataReporter`: ì»¤ìŠ¤í…€ íƒœê·¸
- âœ… `RenderedObjectInfoLabeler`: ë Œë”ë§ëœ ì˜¤ë¸Œì íŠ¸ ì •ë³´
- âœ… `OcclusionLabeler`: ê°€ë¦¼ ë¹„ìœ¨

**í•µì‹¬ íŒŒì¼**:
- `Runtime/GroundTruth/Labelers/CameraLabeler.cs` (500ì¤„)
- `Runtime/GroundTruth/Labelers/BoundingBox/BoundingBoxLabeler.cs`

---

#### CCTV íŠ¹í™” Labelers (ìš°ë¦¬ê°€ ë§Œë“¤ ê²ƒ)

```csharp
// Phase 1: ê¸°ë³¸ Detection
public class PersonDetectionLabeler : BoundingBox2DLabeler {
    // BoundingBox2DLabeler ìƒì†
    // Person íƒœê·¸ë§Œ í•„í„°ë§
}

// Phase 1: ê¸°ë³¸ Tracking
public class TrackingLabeler : CameraLabeler {
    public override string description => "Cross-frame person tracking";

    protected override void OnUpdate() {
        // Global ID í• ë‹¹
        // í”„ë ˆì„ ê°„ ID ìœ ì§€
    }
}

// Phase 2: Appearance
public class AppearanceFeatureLabeler : CameraLabeler {
    // 512-dim ReID feature vector
}

// Phase 2: Crowd Density
public class CrowdDensityLabeler : CameraLabeler {
    // ë°€ì§‘ë„ ì¸¡ì •
}

// Phase 3: Occlusion
public class OcclusionRatioLabeler : CameraLabeler {
    // ê°€ë¦¼ ë¹„ìœ¨ ê³„ì‚°
}
```

---

### 3ï¸âƒ£ Randomization System

**ê°œìš”**: íŒŒë¼ë¯¸í„° ê¸°ë°˜ Domain Randomization í”„ë ˆì„ì›Œí¬

#### 3ë‹¨ ê³„ì¸µ êµ¬ì¡°

```
Scenario (ìƒëª…ì£¼ê¸° ê´€ë¦¬)
  â””â”€ Randomizer (ë³€í™” ë¡œì§)
     â””â”€ Parameter (ì„¤ì • ê°’)
        â””â”€ Sampler (ë‚œìˆ˜ ìƒì„±)
```

---

#### Scenario (ì‹œë‚˜ë¦¬ì˜¤)

```csharp
public class CCTVDatasetScenario : ScenarioBase {
    // Phase 1: ê¸°ë³¸ ì„¤ì •
    public int totalIterations = 100000; // 10ë§Œ í”„ë ˆì„
    public int framesPerIteration = 1;

    protected override void OnIterationStart() {
        // Randomizerë“¤ì´ ì”¬ ë³€ê²½
    }
}
```

**ì£¼ìš” ì—­í• **:
- Randomizer ì»¬ë ‰ì…˜ ê´€ë¦¬
- Iteration ìƒíƒœ ê´€ë¦¬ (í˜„ì¬ frame, sequence)
- Configuration íŒŒë¼ë¯¸í„° ë³´ìœ 

**í•µì‹¬ íŒŒì¼**:
- `Runtime/Randomization/Scenarios/ScenarioBase.cs`

---

#### Randomizer (ëœë¤í™” ë¡œì§)

**ê¸°ë³¸ ì œê³µ (9ê°œ)**:
- âœ… `LightRandomizer`: ì¡°ëª… ë°ê¸°/ìƒ‰ìƒ
- âœ… `MaterialRandomizer`: ì˜¤ë¸Œì íŠ¸ ì¬ì§ˆ
- âœ… `TransformRandomizer`: ìœ„ì¹˜/íšŒì „/í¬ê¸°
- âœ… `VolumeRandomizer`: Post-processing (Bloom, Exposure)
- âœ… `SkyboxRandomizer`: ë°°ê²½ í•˜ëŠ˜

**CCTV íŠ¹í™” (ìš°ë¦¬ê°€ ë§Œë“¤ ê²ƒ)**:
```csharp
// Phase 2: CCTV ë…¸ì´ì¦ˆ
public class CCTVNoiseRandomizer : Randomizer {
    public FloatParameter gaussianNoise = new(0.0f, 0.05f);
    public FloatParameter saltPepperProbability = new(0.0f, 0.01f);

    protected override void OnIterationStart() {
        // Post-processing Volumeì— ë…¸ì´ì¦ˆ ì ìš©
    }
}

// Phase 2: êµ°ì¤‘ í–‰ë™
public class CrowdBehaviorRandomizer : Randomizer {
    public CategoricalParameter<string> behavior =
        new("Idle", "Walk", "Run", "Sit");

    protected override void OnIterationStart() {
        foreach (var person in tagManager.Query<PersonTag>()) {
            string action = behavior.Sample();
            // Animation state ë³€ê²½
        }
    }
}

// Phase 2: êµ°ì¤‘ ë°€ë„
public class CrowdDensityRandomizer : Randomizer {
    public IntParameter personCount = new(10, 50);

    protected override void OnIterationStart() {
        int target = personCount.Sample();
        // Person GameObject ìƒì„±/ì‚­ì œ
    }
}
```

**í•µì‹¬ íŒŒì¼**:
- `Runtime/Randomization/Randomizers/Randomizer.cs`
- `Runtime/Randomization/RandomizerLibrary/` (9ê°œ ê¸°ë³¸ ì œê³µ)

---

#### Parameter + Sampler

**Parameter íƒ€ì…**:
```csharp
// ìˆ«ìí˜•
FloatParameter lightIntensity = new(min: 0.5f, max: 2.0f);
IntParameter personCount = new(10, 50);

// ì¹´í…Œê³ ë¦¬í˜•
CategoricalParameter<string> weather =
    new("Sunny", "Cloudy", "Rainy");

// ìƒ‰ìƒ
ColorHsvaParameter clothColor = new();
```

**Sampler íƒ€ì…**:
- `ConstantSampler`: ê³ ì • ê°’
- `UniformSampler`: ê· ë“± ë¶„í¬
- `NormalSampler`: ì •ê·œ ë¶„í¬ (í‰ê· , í‘œì¤€í¸ì°¨)
- `AnimationCurveSampler`: Unity AnimationCurve ê¸°ë°˜

**ì‚¬ìš© ì˜ˆì‹œ**:
```csharp
public class LightRandomizer : Randomizer {
    public FloatParameter intensity = new FloatParameter {
        value = new UniformSampler(0.5f, 2.0f)
    };

    protected override void OnIterationStart() {
        float randomIntensity = intensity.Sample();
        // ì¡°ëª…ì— ì ìš©
    }
}
```

**í•µì‹¬ íŒŒì¼**:
- `Runtime/Randomization/Parameters/Parameter.cs`
- `Runtime/Randomization/Samplers/SamplerTypes/`

---

#### TagManager (ë™ì  ì˜¤ë¸Œì íŠ¸ ì¿¼ë¦¬)

**ë¬¸ì œ**: Randomizerê°€ ì”¬ì˜ ì–´ë–¤ GameObjectë¥¼ ë³€ê²½í•´ì•¼ í•˜ëŠ”ê°€?

**ì „í†µì  ë°©ë²• (ë‚˜ì¨)**:
```csharp
// í•˜ë“œì½”ë”© - ì”¬ êµ¬ì¡° ë°”ë€Œë©´ ê¹¨ì§
GameObject.Find("Factory/Lights/MainLight");
```

**Unity Perception ë°©ë²• (ì¢‹ìŒ)**:
```csharp
// 1. GameObjectì— Tag ì»´í¬ë„ŒíŠ¸ ë¶™ì´ê¸°
public class PersonTag : RandomizerTag { }
public class CCTVCameraTag : RandomizerTag { }

// 2. Randomizerì—ì„œ ë™ì  ì¿¼ë¦¬
foreach (var person in tagManager.Query<PersonTag>()) {
    // ëª¨ë“  Person GameObject ì°¾ì•„ì„œ ë³€ê²½
}

foreach (var camera in tagManager.Query<CCTVCameraTag>()) {
    // ëª¨ë“  CCTV ì¹´ë©”ë¼ ì°¾ì•„ì„œ ë³€ê²½
}
```

**ì¥ì **:
- ì”¬ êµ¬ì¡° ë³€ê²½ì— ê°•í•¨
- ì‹¤í–‰ ì¤‘ ì˜¤ë¸Œì íŠ¸ ì¶”ê°€/ì‚­ì œ ê°€ëŠ¥
- Prefab ê¸°ë°˜ ìƒì„± ì‹œ ìë™ ì¶”ì 

**í•µì‹¬ íŒŒì¼**:
- `Runtime/Randomization/Randomizers/RandomizerTagManager.cs`
- `Runtime/Randomization/Randomizers/RandomizerTag.cs`

---

### 4ï¸âƒ£ Output Architecture

**ê°œìš”**: ë°ì´í„° ëª¨ë¸ê³¼ ì¶œë ¥ í¬ë§· ë¶„ë¦¬

#### IConsumerEndpoint (ì¶œë ¥ ì¸í„°í˜ì´ìŠ¤)

```csharp
public interface IConsumerEndpoint {
    void StartRecording(SimulationMetadata metadata);
    void ProcessFrame(Frame frame);
    void EndRecording();
}
```

**ê¸°ë³¸ ì œê³µ êµ¬í˜„**:
- âœ… `SoloEndpoint`: SOLO JSON í¬ë§· (ê¸°ë³¸)
- âœ… `PerceptionEndpoint`: ëŒ€ì²´ í¬ë§·
- âœ… `NoOutputEndpoint`: ì¶œë ¥ ì—†ìŒ (í…ŒìŠ¤íŠ¸ìš©)

---

#### SOLO JSON í¬ë§·

**íŒŒì¼ êµ¬ì¡°**:
```
DatasetXXXX/
â”œâ”€â”€ captures_000.json       # í”„ë ˆì„ 0~999
â”œâ”€â”€ captures_001.json       # í”„ë ˆì„ 1000~1999
â”œâ”€â”€ dataset_definition.json # ìŠ¤í‚¤ë§ˆ ì •ì˜
â”œâ”€â”€ sensors/
â”‚   â””â”€â”€ camera_XXXX/
â”‚       â”œâ”€â”€ step0.frame_0.camera.png
â”‚       â””â”€â”€ step0.frame_1.camera.png
â””â”€â”€ metrics/
    â””â”€â”€ ...
```

**dataset_definition.json ì˜ˆì‹œ**:
```json
{
  "version": "0.0.1",
  "metadata": {
    "unityVersion": "2021.3.0f1",
    "perceptionVersion": "0.11.2"
  },
  "sensorDefinitions": [
    {
      "id": "sensor_01",
      "modality": "camera",
      "resolution": {"width": 1920, "height": 1080}
    }
  ],
  "annotationDefinitions": [
    {
      "id": "bounding_box_2d",
      "description": "2D bounding boxes",
      "format": "JSON"
    }
  ]
}
```

**captures_000.json ì˜ˆì‹œ**:
```json
{
  "frames": [
    {
      "frame": 0,
      "sequence": 0,
      "step": 0,
      "timestamp": 0.0,
      "sensors": [
        {
          "sensorId": "sensor_01",
          "imageFile": "sensors/camera_01/step0.frame_0.camera.png"
        }
      ],
      "annotations": [
        {
          "id": "bounding_box_2d",
          "values": [
            {
              "labelId": 1,
              "labelName": "person",
              "bbox": {"x": 100, "y": 200, "width": 50, "height": 120}
            }
          ]
        }
      ]
    }
  ]
}
```

---

#### ìš°ë¦¬ í”„ë¡œì íŠ¸ ì¶œë ¥ ì „ëµ

**Phase 1 (MVP)**:
- âœ… SOLO JSON ê·¸ëŒ€ë¡œ ì‚¬ìš©
- âœ… í›„ì²˜ë¦¬ë¡œ YOLO/COCO ë³€í™˜

**Phase 2 (Production)**:
```csharp
// Custom Endpoint êµ¬í˜„
public class CCTVDatasetEndpoint : IConsumerEndpoint {
    public void ProcessFrame(Frame frame) {
        // ìš°ë¦¬ í¬ë§·ìœ¼ë¡œ ì§ì ‘ ë³€í™˜
        // - YOLO txt
        // - COCO JSON
        // - Manifest.json (ì»¤ìŠ¤í…€)
    }
}
```

**Phase 3 (Enterprise)**:
- ğŸ”„ ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° (gRPC/WebSocket)
- ğŸ”„ Edge NPU í¬ë§· (TFLite, ONNX)

**í•µì‹¬ íŒŒì¼**:
- `Runtime/GroundTruth/Consumers/IConsumerEndpoint.cs`
- `Runtime/GroundTruth/Consumers/Solo/SoloEndpoint.cs`

---

### 5ï¸âƒ£ Data Model

**ê°œìš”**: ì§ë ¬í™”ì— ë…ë¦½ì ì¸ ë°ì´í„° êµ¬ì¡°

#### í•µì‹¬ í´ë˜ìŠ¤

```
DataModelElement (abstract base)
  â”œâ”€ Frame (í”„ë ˆì„ ì»¨í…Œì´ë„ˆ)
  â”‚   â”œâ”€ frame: int
  â”‚   â”œâ”€ sequence: int
  â”‚   â”œâ”€ timestamp: float
  â”‚   â”œâ”€ sensors: List<Sensor>
  â”‚   â”œâ”€ annotations: List<Annotation>
  â”‚   â””â”€ metrics: List<Metric>
  â”‚
  â”œâ”€ Sensor (ì„¼ì„œ ìº¡ì²˜ ê¸°ë¡)
  â”‚   â””â”€ RgbSensor (RGB ì´ë¯¸ì§€)
  â”‚       â”œâ”€ sensorId
  â”‚       â””â”€ imageFile
  â”‚
  â”œâ”€ Annotation (ë¼ë²¨ ë°ì´í„°)
  â”‚   â””â”€ AnnotationDefinition
  â”‚       â”œâ”€ id
  â”‚       â”œâ”€ description
  â”‚       â””â”€ format
  â”‚
  â””â”€ Metric (ë©”íŠ¸ë¦­ ë°ì´í„°)
      â””â”€ MetricDefinition
```

**í•µì‹¬ íŒŒì¼**:
- `Runtime/GroundTruth/DataModel/Frame.cs`
- `Runtime/GroundTruth/DataModel/Annotation.cs`
- `Runtime/GroundTruth/DataModel/Sensor.cs`

---

#### Message Builder íŒ¨í„´

**ëª©ì **: ë°ì´í„° ëª¨ë¸ â†’ ì¶œë ¥ í¬ë§· ë³€í™˜ ë¶„ë¦¬

```csharp
public interface IMessageBuilder {
    void AddFrame(Frame frame);
    void AddSensorDefinition(SensorDefinition def);
    void AddAnnotationDefinition(AnnotationDefinition def);
}

// SOLO JSONìš©
public class SoloMessageBuilder : IMessageBuilder { }

// ìš°ë¦¬ê°€ ë§Œë“¤ ê²ƒ
public class CCTVMessageBuilder : IMessageBuilder {
    public void AddFrame(Frame frame) {
        // YOLO txt ìƒì„±
        // COCO JSON ì¶”ê°€
    }
}
```

**í•µì‹¬ íŒŒì¼**:
- `Runtime/GroundTruth/DataModel/IMessageBuilder.cs`
- `Runtime/GroundTruth/DataModel/IMessageProducer.cs`

---

## ğŸ¯ CCTV í”„ë¡œì íŠ¸ ì í•©ì„± í‰ê°€

### âœ… ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ê²ƒ (50%)

**Camera & Capture**:
- âœ… PerceptionCamera ì»´í¬ë„ŒíŠ¸
- âœ… DatasetCapture ì „ì—­ ê´€ë¦¬
- âœ… AsyncGPUReadback (Phase 2 ëª©í‘œ)

**Labeler ì‹œìŠ¤í…œ**:
- âœ… CameraLabeler ê¸°ë³¸ í´ë˜ìŠ¤
- âœ… BoundingBox2DLabeler (ìƒì† ê¸°ë°˜)
- âœ… AsyncFuture íŒ¨í„´

**Randomization**:
- âœ… Scenario + Randomizer í”„ë ˆì„ì›Œí¬
- âœ… Parameter + Sampler ì‹œìŠ¤í…œ
- âœ… TagManager ì¿¼ë¦¬ íŒ¨í„´
- âœ… LightRandomizer, VolumeRandomizer

**Output**:
- âœ… IConsumerEndpoint ì¸í„°í˜ì´ìŠ¤
- âœ… SOLO JSON (ì„ì‹œ ì‚¬ìš©)
- âœ… Message Builder íŒ¨í„´

---

### âŒ ì§ì ‘ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ê²ƒ (50%)

**CCTV íŠ¹í™” Labelers**:
- âŒ PersonDetectionLabeler (Phase 1)
- âŒ TrackingLabeler (Global ID) (Phase 1)
- âŒ AppearanceFeatureLabeler (512-dim) (Phase 2)
- âŒ CrossCameraIDLabeler (Phase 2)
- âŒ OcclusionRatioLabeler (Phase 3)
- âŒ CrowdDensityLabeler (Phase 2)

**CCTV íŠ¹í™” Randomizers**:
- âŒ CCTVNoiseRandomizer (Gaussian, S&P) (Phase 2)
- âŒ CrowdBehaviorRandomizer (Idle/Walk/Run) (Phase 2)
- âŒ CrowdDensityRandomizer (ìƒì„±/ì‚­ì œ) (Phase 2)

**Crowd Simulation**:
- âŒ NavMesh ê¸°ë°˜ ì´ë™ (Phase 1)
- âŒ BehaviorTree (Phase 2)
- âŒ Appearance ëœë¤í™” (Phase 2)

**Multi-Camera**:
- âŒ 6ëŒ€ ì¹´ë©”ë¼ ë™ê¸°í™” (Phase 2)
- âŒ Cross-camera ID ì¼ê´€ì„± (Phase 2)
- âŒ í†µí•© JSON ìƒì„± (Phase 2)

**ë°ì´í„° í¬ë§·**:
- âŒ SOLO â†’ YOLO ë³€í™˜ (Phase 1 í›„ì²˜ë¦¬)
- âŒ SOLO â†’ COCO ë³€í™˜ (Phase 1 í›„ì²˜ë¦¬)
- âŒ CCTVDatasetEndpoint (Phase 2)
- âŒ Edge NPU í¬ë§· (TFLite, ONNX) (Phase 3)

---

## ğŸ›ï¸ ì±„íƒí•´ì•¼ í•  ì•„í‚¤í…ì²˜ íŒ¨í„´

### 1. Pluggable Labeler íŒ¨í„´

**ì›ì¹™**: ë¼ë²¨ë§ ë¡œì§ì„ PerceptionCameraì—ì„œ ë¶„ë¦¬

**êµ¬í˜„**:
```csharp
// CameraLabeler ìƒì†
public class PersonDetectionLabeler : CameraLabeler {
    protected override void Setup() { /* ì´ˆê¸°í™” */ }
    protected override void OnUpdate() { /* í”„ë ˆì„ë§ˆë‹¤ ì‹¤í–‰ */ }
}

// PerceptionCameraì— ë™ì  ì¶”ê°€
perceptionCamera.labelers.Add(new PersonDetectionLabeler());
```

**ì¥ì **:
- ì½”ì–´ ì½”ë“œ ìˆ˜ì • ì—†ì´ ê¸°ëŠ¥ ì¶”ê°€
- Labeler ì¡°í•© ììœ ë¡­ê²Œ ë³€ê²½
- í…ŒìŠ¤íŠ¸ ìš©ì´

---

### 2. Scenario + Randomizer ê³„ì¸µ

**ì›ì¹™**: ì„¤ì •(Parameter)ê³¼ ë¡œì§(Randomizer)ì„ ë¶„ë¦¬

**êµ¬í˜„**:
```csharp
// Scenario: ì„¤ì • ê´€ë¦¬
public class CCTVScenario : ScenarioBase {
    public LightRandomizer lightRandomizer;
    public CCTVNoiseRandomizer noiseRandomizer;
}

// Randomizer: ë¡œì§ êµ¬í˜„
public class LightRandomizer : Randomizer {
    public FloatParameter intensity; // ì„¤ì •

    protected override void OnIterationStart() {
        // ë¡œì§
    }
}
```

**ì¥ì **:
- Configuration íŒŒì¼ë¡œ íŒŒë¼ë¯¸í„° ì¡°ì • ê°€ëŠ¥
- ì½”ë“œ ë³€ê²½ ì—†ì´ ì‹¤í—˜ ë³€ê²½
- Reproducible (ì‹œë“œ ê¸°ë°˜)

---

### 3. AsyncFuture íŒ¨í„´

**ì›ì¹™**: ë¹„ë™ê¸° ì‘ì—…ì„ ë¸”ë¡œí‚¹ ì—†ì´ ì²˜ë¦¬

**êµ¬í˜„**:
```csharp
protected override void OnUpdate() {
    // AsyncFuture ë°˜í™˜ (GPU ì‘ì—… ì™„ë£Œ ëŒ€ê¸°)
    var future = AsyncGPUReadback.Request(renderTexture);

    sensorHandle.ReportAnnotationAsync(
        annotationDef,
        future.ContinueWith(data => {
            // GPU ì‘ì—… ì™„ë£Œ í›„ ì‹¤í–‰
            return GenerateAnnotation(data);
        })
    );
}
```

**ì¥ì **:
- GPU â†’ CPU ì „ì†¡ ë™ì•ˆ ë‹¤ë¥¸ ì‘ì—… ê°€ëŠ¥
- Phase 2 ëª©í‘œ (15 FPS ë‹¬ì„±)

---

### 4. Message Builder íŒ¨í„´

**ì›ì¹™**: ë°ì´í„° ëª¨ë¸ê³¼ ì¶œë ¥ í¬ë§· ë¶„ë¦¬

**êµ¬í˜„**:
```csharp
// ë°ì´í„° ëª¨ë¸ (ë³€í•˜ì§€ ì•ŠìŒ)
Frame frame = new Frame {
    frame = 0,
    annotations = annotations
};

// ì¶œë ¥ í¬ë§· (êµì²´ ê°€ëŠ¥)
IMessageBuilder soloBuilder = new SoloMessageBuilder();
IMessageBuilder yoloBuilder = new YOLOMessageBuilder();

frame.ToMessage(soloBuilder); // SOLO JSON
frame.ToMessage(yoloBuilder); // YOLO txt
```

**ì¥ì **:
- ì¶œë ¥ í¬ë§· ë³€ê²½ ì‹œ ë°ì´í„° ëª¨ë¸ ìˆ˜ì • ë¶ˆí•„ìš”
- ì—¬ëŸ¬ í¬ë§· ë™ì‹œ ì¶œë ¥ ê°€ëŠ¥

---

### 5. Tag ê¸°ë°˜ ì¿¼ë¦¬

**ì›ì¹™**: GameObject ì°¸ì¡°ë¥¼ í•˜ë“œì½”ë”©í•˜ì§€ ì•ŠìŒ

**ë‚˜ìœ ì˜ˆ**:
```csharp
GameObject person1 = GameObject.Find("Factory/Crowd/Person_001");
GameObject person2 = GameObject.Find("Factory/Crowd/Person_002");
// ì”¬ êµ¬ì¡° ë°”ë€Œë©´ ê¹¨ì§
```

**ì¢‹ì€ ì˜ˆ**:
```csharp
// Tag ë¶™ì´ê¸°
person.AddComponent<PersonTag>();

// ë™ì  ì¿¼ë¦¬
foreach (var person in tagManager.Query<PersonTag>()) {
    // ëª¨ë“  Person ìë™ìœ¼ë¡œ ì°¾ìŒ
}
```

**ì¥ì **:
- ì”¬ êµ¬ì¡° ë³€ê²½ì— ê°•í•¨
- Prefab ìƒì„± ì‹œ ìë™ ì¶”ì 
- ì‹¤í–‰ ì¤‘ ì˜¤ë¸Œì íŠ¸ ì¶”ê°€/ì‚­ì œ ê°€ëŠ¥

---

## ğŸ“Š Gap ë¶„ì„

| ê¸°ëŠ¥ | Unity Perception | ìš°ë¦¬ í•„ìš” | Gap | ë‚œì´ë„ |
|------|-----------------|----------|-----|--------|
| **Camera Capture** | âœ… ë‹¨ì¼ ì¹´ë©”ë¼ | âœ… 6ëŒ€ ë™ê¸°í™” | ğŸŸ¡ Multi-cam ë™ê¸°í™” | ì¤‘ê°„ |
| **Labeler ì‹œìŠ¤í…œ** | âœ… 15ê°œ ì œê³µ | âœ… CCTV íŠ¹í™” | ğŸŸ¡ 4~5ê°œ ì¶”ê°€ | ì¤‘ê°„ |
| **Randomization** | âœ… 9ê°œ ì œê³µ | âœ… CCTV íŠ¹í™” | ğŸŸ¢ 2~3ê°œ ì¶”ê°€ | ë‚®ìŒ |
| **Crowd Simulation** | âŒ ì—†ìŒ | âœ… í•„ìˆ˜ | ğŸ”´ ì „ì²´ êµ¬í˜„ | **ë†’ìŒ** |
| **AsyncGPU** | âœ… êµ¬í˜„ë¨ | âœ… Phase 2 | ğŸŸ¢ ì¬ì‚¬ìš© | ì—†ìŒ |
| **JSON ì¶œë ¥** | âœ… SOLO | âœ… Custom | ğŸŸ¡ ë³€í™˜ í•„ìš” | ë‚®ìŒ |
| **Cross-camera ID** | âŒ ì—†ìŒ | âœ… í•„ìˆ˜ | ğŸ”´ ì „ì²´ êµ¬í˜„ | ë†’ìŒ |
| **Occlusion** | ğŸŸ¡ ê¸°ë³¸ë§Œ | âœ… ë¹„ìœ¨ ê³„ì‚° | ğŸŸ¡ í™•ì¥ | ì¤‘ê°„ |

---

## ğŸš€ í†µí•© ì „ëµ

### Phase 1: ê¸°ë³¸ í†µí•© (3ê°œì›”)

**Unity Perception í™œìš©**:
- âœ… PerceptionCamera
- âœ… BoundingBox2DLabeler (ìƒì†)
- âœ… DatasetCapture
- âœ… SOLO JSON (ì„ì‹œ)

**ì§ì ‘ êµ¬í˜„**:
- âœ… PersonDetectionLabeler (BoundingBox2D ìƒì†)
- âœ… TrackingLabeler (ê°„ë‹¨í•œ ID ìœ ì§€)
- âœ… NavMesh ê¸°ë°˜ Crowd (20~30ëª…)

**ì¶œë ¥**:
- í›„ì²˜ë¦¬ ìŠ¤í¬ë¦½íŠ¸ë¡œ SOLO â†’ YOLO ë³€í™˜

---

### Phase 2: í™•ì¥ (6ê°œì›”)

**Unity Perception í™œìš©**:
- âœ… LightRandomizer
- âœ… VolumeRandomizer (Post-processing)
- âœ… AsyncGPUReadback

**ì§ì ‘ êµ¬í˜„**:
- âœ… CCTVNoiseRandomizer
- âœ… CrowdBehaviorRandomizer
- âœ… AppearanceFeatureLabeler (512-dim)
- âœ… Multi-camera ë™ê¸°í™” (6ëŒ€)
- âœ… CCTVDatasetEndpoint (YOLO ì§ì ‘ ìƒì„±)

---

### Phase 3: ìµœì í™” (9ê°œì›”)

**ì§ì ‘ êµ¬í˜„**:
- âœ… OcclusionRatioLabeler
- âœ… Scene Pooling (5ê°œ ì”¬)
- âœ… Multi-GPU ë³‘ë ¬í™”
- âœ… Edge NPU í¬ë§· (TFLite, ONNX)

---

## ğŸ“– ë‹¤ìŒ ë‹¨ê³„

### ê°œë°œ ì‹œì‘í•˜ê¸°
**[3_ê°œë°œì_ì°¸ì¡°.md â†’](3_ê°œë°œì_ì°¸ì¡°.md)**
- Labeler ê°œë°œ ê°€ì´ë“œ
- Randomizer ê°œë°œ ê°€ì´ë“œ
- ì½”ë“œ ì˜ˆì œ ë° íŒ¨í„´

### íŒŒì¼ êµ¬ì¡° ë³´ê¸°
**[reference/ë””ë ‰í† ë¦¬_êµ¬ì¡°.txt â†’](reference/ë””ë ‰í† ë¦¬_êµ¬ì¡°.txt)**
- 100+ íŒŒì¼ ë§µ
- ì¤‘ìš” íŒŒì¼ ìœ„ì¹˜

---

## ğŸ¯ í•µì‹¬ ìš”ì•½

1. **5ëŒ€ ì»´í¬ë„ŒíŠ¸**: Camera, Labeler, Randomizer, Output, DataModel
2. **50% ì¬ì‚¬ìš© ê°€ëŠ¥**: Camera, Labeler í”„ë ˆì„ì›Œí¬, Randomizer ì‹œìŠ¤í…œ
3. **50% ì§ì ‘ êµ¬í˜„**: CCTV Labeler, Crowd Simulation, Multi-cam
4. **í•µì‹¬ íŒ¨í„´ 5ê°€ì§€**: Pluggable, Scenario, AsyncFuture, MessageBuilder, Tag-based

**ë‹¤ìŒ ì½ê¸°**: [3_ê°œë°œì_ì°¸ì¡°.md](3_ê°œë°œì_ì°¸ì¡°.md) â†’
